<!-- product.component.html -->
<section class="product-root" *ngIf="product; else loadingTpl">
  <div class="product-top grid">
    <!-- Imagen principal -->
    <div class="col-12 md:col-6">
      <p-card>
        <ng-container *ngIf="product.image_url; else noImg">
          <p-image
            [src]="product.image_url"
            [alt]="product.name"
            width="100%"
            [preview]="true"
          ></p-image>
        </ng-container>
        <ng-template #noImg>
          <div class="p-text-center p-py-6">üñºÔ∏è Sin imagen disponible</div>
        </ng-template>
      </p-card>
    </div>

    <!-- Info producto -->
    <div class="col-12 md:col-6">
      <p-card>
        <h1 class="text-2xl font-bold mb-2">{{ product.name }}</h1>
        <div class="text-xl text-primary mb-3">üí∞ ${{ product.price }}</div>

        <p class="mb-4">{{ product.description }}</p>

        <p class="mb-3">
          <strong>Tama√±o:</strong> {{ product.size }} cm
        </p>

        <!-- Controles -->
        <div class="flex align-items-center gap-3 mb-4">
          <p-inputNumber
            [(ngModel)]="qty"
            [min]="1"
            [max]="product.stock || 9999"
            mode="decimal"
            showButtons
            buttonLayout="horizontal"
            decrementButtonClass="p-button-danger"
            incrementButtonClass="p-button-success"
            incrementButtonIcon="pi pi-plus"
            decrementButtonIcon="pi pi-minus"
          ></p-inputNumber>

          <p-button
            label="{{ adding ? 'A√±adiendo...' : 'A√±adir al carrito' }}"
            icon="pi pi-shopping-cart"
            [disabled]="adding"
            (onClick)="addToCart()"
            styleClass="p-button-lg p-button-rounded"
          ></p-button>
        </div>
      </p-card>
    </div>
  </div>

  <!-- descripci√≥n larga / galer√≠a -->
  <div class="product-bottom mt-5">
    <p-card header="Descripci√≥n Detallada">
      <p>{{ product.description }}</p>

      <div class="gallery mt-4 flex flex-wrap gap-3">
        <div class="gallery-item" *ngIf="product.image_url">
          <p-image
            [src]="product.image_url"
            alt="Imagen extra"
            width="200"
            [preview]="true"
          ></p-image>
        </div>
      </div>
    </p-card>
  </div>
</section>

<!-- Loading -->
<ng-template #loadingTpl>
  <div class="flex justify-content-center align-items-center p-6">
    <p-progressSpinner></p-progressSpinner>
    <span class="ml-3">Cargando producto‚Ä¶</span>
  </div>
</ng-template>
